# Common Vulnerabilities

This section covers frequently encountered security vulnerabilities during penetration tests, including their characteristics, identification methods, and potential impacts.

## üìã Table of Contents

1. [OWASP Top 10](#owasp-top-10)
2. [Network Vulnerabilities](#network-vulnerabilities)
3. [System Vulnerabilities](#system-vulnerabilities)
4. [Web Application Vulnerabilities](#web-application-vulnerabilities)
5. [Tools & Commands](#-tools--commands)
6. [Best Practices](#-best-practices)

## OWASP Top 10 (2021)

1. **Broken Access Control**
   - Insecure direct object references (IDOR)
   - Missing function level access control
   - CORS misconfigurations

2. **Cryptographic Failures**
   - Weak encryption algorithms
   - Improper certificate validation
   - Hardcoded credentials

3. **Injection**
   - SQL Injection
   - Command Injection
   - LDAP Injection
   - XPath Injection

4. **Insecure Design**
   - Missing security controls
   - Insecure by default configurations
   - Lack of threat modeling

5. **Security Misconfiguration**
   - Default accounts and passwords
   - Unnecessary services enabled
   - Verbose error messages

6. **Vulnerable and Outdated Components**
   - Unpatched software
   - Known vulnerable libraries
   - End-of-life software

7. **Identification and Authentication Failures**
   - Weak password policies
   - Insecure password recovery
   - Session fixation

8. **Software and Data Integrity Failures**
   - Insecure deserialization
   - Insecure updates
   - CI/CD pipeline vulnerabilities

9. **Security Logging and Monitoring Failures**
   - Missing logs
   - Inadequate log monitoring
   - Lack of alerting

10. **Server-Side Request Forgery (SSRF)**
    - Internal service abuse
    - Cloud metadata API access
    - Bypass of network controls

## Network Vulnerabilities

### Common Network Issues
- Clear-text protocols (FTP, Telnet, HTTP)
- Weak encryption (SSLv3, TLS 1.0/1.1)
- Open ports with vulnerable services
- SNMP with default community strings

### Example Vulnerable Services
- SMBv1 (EternalBlue)
- RDP with weak encryption
- VNC with no authentication
- Redis with no authentication

## System Vulnerabilities

### Operating System Issues
- Unpatched systems
- Default credentials
- Insecure service configurations
- Weak file permissions

### Common System Vulnerabilities
- Dirty Pipe (Linux)
- PrintNightmare (Windows)
- Sudo privilege escalation
- Kernel exploits

## Web Application Vulnerabilities

### Common Web Issues
- Cross-Site Scripting (XSS)
- Cross-Site Request Forgery (CSRF)
- Server-Side Request Forgery (SSRF)
- XML External Entity (XXE) Injection
- Insecure Direct Object References (IDOR)

### API-Specific Issues
- Broken Object Level Authorization (BOLA)
- Excessive Data Exposure
- Mass Assignment
- Improper Assets Management

## üõ† Tools & Commands

| Tool | Purpose | Example |
|------|---------|---------|
| Nmap | Network scanning | `nmap -sV --script=vuln -p- 192.168.1.100` |
| Nikto | Web server scanning | `nikto -h http://example.com` |
| OWASP ZAP | Web app scanning | `zap-cli quick-scan -s xss,sqli http://example.com` |
| Searchsploit | Exploit database | `searchsploit apache 2.4.29` |
| Metasploit | Exploit framework | `msfconsole -q -x 'use exploit/multi/handler; set payload windows/meterpreter/reverse_tcp; set LHOST 192.168.1.2; set LPORT 4444; exploit'` |
| WPScan | WordPress scanning | `wpscan --url http://example.com --enumerate vp,vt,tt,cb,dbe,u` |
| SQLmap | SQL injection | `sqlmap -u "http://example.com/page.php?id=1" --dbs` |

## üìù Best Practices

1. **Regular Scanning**
   - Schedule regular vulnerability scans
   - Scan after significant changes
   - Use both authenticated and unauthenticated scans

2. **Remediation**
   - Prioritize by risk level
   - Test patches before deployment
   - Document all remediation actions

3. **Documentation**
   - Maintain an asset inventory
   - Track vulnerability status
   - Document false positives

4. **Continuous Improvement**
   - Update tools and signatures regularly
   - Stay informed about new vulnerabilities
   - Conduct regular security training

## üìö Resources

- [OWASP Top 10](https://owasp.org/Top10/)
- [CWE Top 25](https://cwe.mitre.org/top25/)
- [CVE Details](https://www.cvedetails.com/)
- [NIST National Vulnerability Database](https://nvd.nist.gov/)
- [Exploit Database](https://www.exploit-db.com/)

## ‚ö†Ô∏è Legal and Ethical Considerations

- Only test systems you own or have explicit permission to test
- Be aware of and comply with all applicable laws and regulations
- Document your authorization and scope
- Be prepared to provide evidence of authorization if questioned
